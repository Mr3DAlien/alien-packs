# Checks if space it is getting placed at is air and if there is no player standing in the space then calls the rotation function
execute if block ~ ~ ~ minecraft:air unless entity @a[distance=..0.8] positioned ~ ~-1 ~ unless entity @a[distance=..0.8] positioned ~ ~1 ~ run function ap-rm_portal_gun:portal_placer/create/rotation
# Gives the portal placer back to the player when placing fails
execute if entity @a[distance=..0.8] as @p[scores={ap-rm_use_spawn_egg=1..}] run give @s[gamemode=!creative] minecraft:bat_spawn_egg{CustomModelData:2,EntityTag:{id:"minecraft:armor_stand",Invisible:1b,Small:1b,Marker:1b,Tags:["ap-rm_placer_stand"]},display:{Name:'{"translate":"item.alien-packs.rm_portal_gun.portal_placer.name","italic":"false"}'}} 1
execute positioned ~ ~-1 ~ if entity @a[distance=..0.8] as @p[scores={ap-rm_use_spawn_egg=1..}] run give @s[gamemode=!creative] minecraft:bat_spawn_egg{CustomModelData:2,EntityTag:{id:"minecraft:armor_stand",Invisible:1b,Small:1b,Marker:1b,Tags:["ap-rm_placer_stand"]},display:{Name:'{"translate":"item.alien-packs.rm_portal_gun.portal_placer.name","italic":"false"}'}} 1
# Spawns the portal placer at the floor if the space it wants to get placed at is not valid
execute unless block ~ ~ ~ minecraft:air unless block ~ ~ ~ minecraft:barrel run summon minecraft:item ~ ~ ~ {Item:{id:"minecraft:bat_spawn_egg",Count:1b,tag:{CustomModelData:2,EntityTag:{id:"minecraft:armor_stand",Invisible:1b,Small:1b,Marker:1b,Tags:["ap-rm_placer_stand"]},display:{Name:'{"translate":"item.alien-packs.rm_portal_gun.portal_placer.name","italic":"false"}'}}}}
# Kills itself if non of the other functions already killed the entity
kill @s